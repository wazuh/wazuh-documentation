.. Copyright (C) 2015, Wazuh, Inc.

.. meta::
   :description: The Vulnerability Detection module works with the Syscollector module to detect vulnerable packages and software on a monitored endpoint.

Configuration
=============

The Vulnerability Detection module is enabled by default on the Wazuh manager and works with the :doc:`Syscollector module </user-manual/capabilities/system-inventory/index>` to detect vulnerable packages and software on a monitored endpoint.

The block below is the default vulnerability detection settings in the Wazuh manager :doc:`configuration file </user-manual/reference/ossec-conf/index>` at ``/var/ossec/etc/ossec.conf``.

.. code-block:: xml

   <vulnerability-detection>
      <enabled>yes</enabled>
      <index-status>yes</index-status>
      <feed-update-interval>60m</feed-update-interval>
   </vulnerability-detection>

Where:

-  ``<enabled>`` specifies whether the Vulnerability Detection module is enabled or not. The default value is ``yes``. The allowed values are ``yes`` and ``no``.
-  ``<index-status>`` enables the indexing of vulnerability inventory data. The default value is ``yes``. The allowed values are ``yes`` and ``no``.
-  ``<feed-update-interval>`` specifies the time interval for periodic feed updates. The default value is ``60m`` (one hour), the minimum allowed. The allowed value is a positive number that contains a suffix character indicating a time unit, such as ``s`` (seconds), ``m`` (minutes), ``h`` (hours), and ``d`` (days).

.. note::

   To enable vulnerability detection on the Wazuh manager, modify the ``internal_options.conf`` file at ``/var/ossec/etc/internal_options.conf``. Set the parameter ``vulnerability-detection.disable_scan_manager`` from ``1`` to ``0``. This change allows the Vulnerability Detection module to include the Wazuh manager host in its scans. After updating the configuration, restart the Wazuh manager to ensure the changes take effect.

The :doc:`Syscollector module </user-manual/capabilities/system-inventory/index>` sends system inventory data from the monitored endpoint to the Wazuh manager for analysis that identifies vulnerable packages and software. The following configuration block shows the default settings for the Syscollector module on a Wazuh agent.

.. code-block:: xml

   <!-- System inventory -->
   <wodle name="syscollector">
     <disabled>no</disabled>
     <interval>1h</interval>
     <scan_on_start>yes</scan_on_start>
     <hardware>yes</hardware>
     <os>yes</os>
     <network>yes</network>
     <packages>yes</packages>
     <hotfixes>yes</hotfixes>
     <ports all="no">yes</ports>
     <processes>yes</processes>

     <!-- Database synchronization settings -->
     <synchronization>
       <max_eps>10</max_eps>
     </synchronization>
   </wodle>

You can find the Syscollector configuration in the Wazuh agent configuration file at:

-  ``/var/ossec/etc/ossec.conf`` for Linux endpoints.
-  ``C:\Program Files (x86)\ossec-agent\ossec.conf`` for Windows endpoints.
-  ``/Library/Ossec/ossec.conf`` for macOS endpoints.

Refer to the :doc:`Syscollector configuration </user-manual/capabilities/system-inventory/configuration>` for more information.
