.. _amazon:

AWS integration
=================

This section provides instructions to integrate Wazuh with Amazon Web Services (AWS). It also explains different use cases as examples on how the rules, developed by Wazuh, can be used to alert on specific events. In `our github repository <http://github.com/wazuh/wazuh-ruleset/>`_ there are rules for IAM, EC2 and VPC services.

The diagram below explains how a log message, generated by an AWS event, flows until it arrives to the Wazuh agent. Once the agent reads the message, it sends it to the Wazuh manager which performs the analysis using the rules. When a rule matches, an alert is triggered (if the level is high enough).

.. thumbnail:: ../images/aws/aws-diagram.png
    :align: center
    :width: 100%

1. CloudTrail is a web service that records AWS API calls for your account and delivers log files. Meaning that, when an AWS event occurs, Cloudtrail generates the log message. Using CloudTrail we can get more visibility into AWS user activity, tracking changes made to AWS resources.
2. Once an event takes place, CloudTrail delivers the log message to Amazon S3, writing it to a log file. S3 allows log files to be stored durably and inexpensively.
3. The script ``getawslog.py`` downloads the logs files from Amazon S3 into the Wazuh agent, uncompressing them and appending new data to a local plain text file.

This diagram makes it easier to understand the integration process described on the next pages.

.. topic:: Contents

    .. toctree::
       :maxdepth: 2

       integration
       use-cases/index
