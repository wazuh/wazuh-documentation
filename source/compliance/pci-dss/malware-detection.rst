.. Copyright (C) 2015, Wazuh, Inc.

.. meta::
  :description: Wazuh offers several capabilities that support malware detection. Learn more about it in this section.
  
Malware detection
=================

Wazuh offers several capabilities that support malware detection. These detections can be done by:

-  :doc:`Finding patterns in the system that do not match expected behavior using the rootcheck component </user-manual/capabilities/malware-detection/index>`
-  :doc:`Integrating with VirusTotal to detect and remove malware </proof-of-concept-guide/detect-remove-malware-virustotal>`
-  :doc:`Integrating with YARA to detect malware </proof-of-concept-guide/detect-malware-yara-integration>`
-  `Using CDB lists to detect and remove malicious files <https://wazuh.com/blog/detecting-and-responding-to-malicious-files-using-cdb-lists-and-active-response/>`_

These malware detection components help meet the following PCI DSS requirement:

-  **Requirement 5 - Protect All Systems and Networks from Malicious Software**: Malicious software (malware) is software or firmware designed to infiltrate or damage a computer system without the owner's knowledge or consent, with the intent of compromising the confidentiality, integrity, or availability of the ownerâ€™s data, applications, or operating system. The goal of this requirement is to protect systems from current and evolving malware threats. 

To help meet the above PCI DSS requirement, Wazuh uses a combination of rootcheck, CDB lists, integrations with VirusTotal and YARA, and active response to detect and remove malicious files.

Use cases
---------

-  PCI DSS 5.2.2 requires that the deployed anti-malware solution(s):

   -  Detects all known types of malware.
   -  Removes, blocks, or contains all known types of malware.

   Detecting a rootkit is a sample case for malware detection. The rootcheck module runs several tests to detect rootkits. One of them checks for files hidden in ``/dev``. The ``/dev`` directory should only contain device-specific files such as the primary IDE hard disk (``/dev/hda``), and the kernel random number generators (``/dev/random`` and ``/dev/urandom``), among others. Any additional files, beyond the expected device-specific files, needs inspection. Many rootkits use ``/dev`` as a storage partition to hide files. 

   In the following example we have a rootkit on the endpoint that creates hidden files in ``/lib/udev/rules.d``. When the rootcheck scan is run, an alert is generated detecting the hidden files.

   .. thumbnail:: /images/compliance/pci/host-based-anomaly-detection-event.png
      :title: Host-based anomaly detection event (rootcheck)
      :align: center
      :width: 80%
