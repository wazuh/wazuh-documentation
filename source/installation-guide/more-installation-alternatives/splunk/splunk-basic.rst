.. Copyright (C) 2022 Wazuh, Inc.

.. meta:: :description: Splunk for Wazuh installation guide

.. _splunk_basic:

Install Splunk in single-instance mode
======================================

This document will guide you through the installation process for a single-instance multitier server, recommended for testing and evaluation purposes, or also for small-medium sized environments.

.. note::
  Many of the commands described below need to be executed with root user privileges.

These are the two main components in this type of multitier server:

- The **indexer** runs the Splunk engine. It reads forwarded data, parses, indexes and stores it as events that contain alert data generated by Wazuh manager sent by the Forwarder instance.
- The **forwarder** runs on the Wazuh manager and the Wazuh API instance, it reads local data and sends it to the indexer.

.. thumbnail:: ../../../images/splunk-app/simple-distributed-arch.png
  :align: center
  :width: 80%
  :title: Diagram of a single-instance Splunk architecture

.. warning::
  This documentation will install Splunk using the single-instance deployment schema. If you want a more advanced installation, check out the :ref:`multi-instance <splunk_distributed>` deployment schema.

Install Splunk Indexer
----------------------

This component works receiving the data flow streamed by a forwarder and stores it in a Splunk index.

1. Download Splunk v|SPLUNK_LATEST| package from `its official website <https://www.splunk.com/en_us/download/partners/splunk-enterprise.html>`_.

    .. note::
      Splunk is not open source software and it requires a registered user and license in order to work. You can also use a free trial license.

2. Install the Splunk v|SPLUNK_LATEST| package:

    a) For RPM based distributions:

      .. code-block:: console

        # yum install splunk-enterprise-package.rpm

    b) For Debian/Ubuntu distributions:

      .. code-block:: console

        # dpkg --install splunk-enterprise-package.deb
        
3. Configure ``inputs.conf`` and ``indexes.conf``:

    a) Create ``indexes.conf``:

      .. code-block:: console

        # curl -so /opt/splunk/etc/system/local/indexes.conf https://raw.githubusercontent.com/wazuh/wazuh-splunk/v|WAZUH_SPLUNK_LATEST|-|SPLUNK_LATEST|/setup/indexer/indexes.conf

    b) Create ``Ã¬nputs.conf``:

      .. code-block:: console

        # curl -so /opt/splunk/etc/system/local/inputs.conf https://raw.githubusercontent.com/wazuh/wazuh-splunk/v|WAZUH_SPLUNK_LATEST|-|SPLUNK_LATEST|/setup/indexer/inputs.conf

4. Ensure Splunk v|SPLUNK_LATEST| is installed in ``/opt/splunk`` and start the service:

      .. code-block:: console

        # /opt/splunk/bin/splunk start


5. Optional. If you additionally want the Splunk service to start at boot time, please execute the following command:

    .. code-block:: console

      # /opt/splunk/bin/splunk enable boot-start

Now that you've finished installing Splunk on a single-instance mode, you can proceed with the next step and install the :ref:`Wazuh app for Splunk <splunk_app>`.

Additional links
----------------

- You can find useful Splunk CLI commands in the `official documentation <http://docs.splunk.com/Documentation/Splunk/|SPLUNK_LATEST|/Admin/CLIadmincommands>`_ .
